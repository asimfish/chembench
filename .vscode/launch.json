{
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        // ============================================
        // 通用调试配置
        // ============================================
        {
            "name": "Python 调试程序: 当前文件",
            "type": "debugpy",
            "request": "launch",
            "program": "${file}",
            "console": "integratedTerminal"
        },

        // ============================================
        // Diffusion Policy 训练配置（新版）
        // 使用说明：修改 task/*.yaml 中的 object_name 和 num_demos
        // ============================================
        // RGB任务训练 - 使用图像输入（修改 task/grasp_rgb.yaml）
        {
            "name": "DP:Train-Grasp-RGB",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/diffusion_policy/train.py",
            "console": "integratedTerminal",
            "args": [
                "--config-name",
                "train_diffusion_transformer_timm_workspace",
                "task=grasp_rgb"
            ],
            "env": {
                "CUDA_VISIBLE_DEVICES": "0"
            },
            "justMyCode": false
        },
        // State任务训练 - 仅使用状态输入（修改 task/grasp_state.yaml）
        {
            "name": "DP:Train-Grasp-State",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/diffusion_policy/train.py",
            "console": "integratedTerminal",
            "args": [
                "--config-name",
                "train_diffusion_transformer_state_workspace",
                "task=grasp_state"
            ],
            "env": {
                "CUDA_VISIBLE_DEVICES": "1"
            },
            "justMyCode": false
        },
        // Handover RGB训练（修改 task/handover_rgb.yaml）
        // {
        //     "name": "DP:Train-Handover-RGB",
        //     "type": "debugpy",
        //     "request": "launch",
        //     "program": "${workspaceFolder}/diffusion_policy/train.py",
        //     "console": "integratedTerminal",
        //     "args": [
        //         "--config-name",
        //         "train_diffusion_transformer_timm_workspace",
        //         "task=handover_rgb"
        //     ],
        //     "env": {
        //         "CUDA_VISIBLE_DEVICES": "4"
        //     },
        //     "justMyCode": false
        // },
        // Handover State训练（修改 task/handover_state.yaml）
        // {
        //     "name": "DP:Train-Handover-State",
        //     "type": "debugpy",
        //     "request": "launch",
        //     "program": "${workspaceFolder}/diffusion_policy/train.py",
        //     "console": "integratedTerminal",
        //     "args": [
        //         "--config-name",
        //         "train_diffusion_transformer_state_workspace",
        //         "task=handover_state"
        //     ],
        //     "env": {
        //         "CUDA_VISIBLE_DEVICES": "4"
        //     },
        //     "justMyCode": false
        // },

        // // ============================================
        // // Diffusion Policy 旧版训练配置（保留兼容）
        // // ============================================
        // {
        //     "name": "DP:Train-Legacy",
        //     "type": "debugpy",
        //     "request": "launch",
        //     "program": "${workspaceFolder}/diffusion_policy/train.py",
        //     "console": "integratedTerminal",
        //     "args": [
        //         "--config-name",
        //         "train_diffusion_transformer_timm_single_demo_workspace",
        //     ],
        //     "env": {
        //         "CUDA_VISIBLE_DEVICES": "4"  // 指定 GPU，可改为 "1", "0,1" 等
        //     },
        //     "justMyCode": false
        // },
        // {
        //     "name": "DP:Grasp-Lego-Train-Legacy",
        //     "type": "debugpy",
        //     "request": "launch",
        //     "program": "${workspaceFolder}/diffusion_policy/train.py",
        //     "console": "integratedTerminal",
        //     "args": [
        //         "--config-name",
        //         "train_diffusion_transformer_grasp_lego_workspace",
        //     ],
        //     "env": {
        //         "CUDA_VISIBLE_DEVICES": "4"  // 指定 GPU，可改为 "1", "0,1" 等
        //     },
        //     "justMyCode": false
        // },

        // ============================================
        // IsaacSim 启动配置
        // ============================================
        {
            "name": "IsaacSim: Run",
            "type": "node-terminal",
            "request": "launch",
            "command": "./psilab/issacsim/run.sh"
        },

        
        {
            "name": "TP-Grasp-Param-Finder-v1:DataCollect",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--task",
                "Psi-TP-Grasp-Param-Finder-v1",
                "--num_envs",
                "1",
                "--seed",
                "17",
                "--scene",
                "room_cfg:PSI_DC_Beaker_003_CFG",
                "--enable_cameras",
                "--enable_output",
                "--enable_random",
                "--enable_eval",
                "--async_reset",
                "--sample_step",
                "4",
                "--max_episode",
                "100",
            ],
            "program": "${workspaceFolder}/psilab/scripts_psi/workflows/motion_planning/play.py",
            "console": "integratedTerminal",
            "justMyCode": false
        },

        // ============================================
        // Diffusion Policy 批量评估
        // 使用说明：编辑 eval_configs.yaml 配置要测试的模型
        // ============================================
        {
            "name": "IL-Batch-Eval",
            "type": "node-terminal",
            "request": "launch",
            "command": "cd ${workspaceFolder}/psilab/scripts_psi/workflows/imitation_learning && bash batch_eval_yaml.sh"
        },

        // ============================================
        // Diffusion Policy 单次测试配置
        // 使用说明：
        //   - RGB模式: 使用图像+状态输入，需要 --enable_cameras
        //   - State模式: 仅使用状态输入，不需要相机
        //   - 修改 --checkpoint 为要测试的模型路径
        //   - 修改 --scene 为要测试的物体场景
        // ============================================
        // RGB模式测试
        // {
        //     "name": "IL-Eval-RGB",
        //     "type": "debugpy",
        //     "request": "launch",
        //     "args": [
        //         "--task",
        //         "Psi-IL-Grasp-Beaker-003-v1",
        //         "--num_envs",
        //         "1",
        //         "--seed",
        //         "17",
        //         "--scene",
        //         "room_cfg:PSI_DC_Beaker_003_CFG",  // 可选: PSI_DC_Beaker_002_CFG, PSI_DC_Beaker_005_CFG, PSI_DC_Crucible_CFG
        //         "--enable_cameras",
        //         "--async_reset",
        //         "--checkpoint",
        //         "/home/psibot/chembench/data/outputs/grasp_rgb/100ml玻璃烧杯/xxx/checkpoints/latest.ckpt",
        //         "--max_step",
        //         "500",
        //         "--max_episode",
        //         "100",
        //         "--enable_eval",
        //     ],
        //     "program": "${workspaceFolder}/psilab/scripts_psi/workflows/imitation_learning/play.py",
        //     "console": "integratedTerminal",
        //     "justMyCode": false
        // },
        // State模式测试
        // {
        //     "name": "IL-Eval-State",
        //     "type": "debugpy",
        //     "request": "launch",
        //     "args": [
        //         "--task",
        //         "Psi-IL-Grasp-Beaker-003-State-v1",  // State模式的task
        //         "--num_envs",
        //         "1",
        //         "--seed",
        //         "17",
        //         "--scene",
        //         "room_cfg:PSI_DC_Beaker_003_CFG",
        //         "--async_reset",
        //         "--checkpoint",
        //         "/home/psibot/chembench/data/outputs/grasp_state/100ml玻璃烧杯/xxx/checkpoints/latest.ckpt",
        //         "--max_step",
        //         "500",
        //         "--max_episode",
        //         "100",
        //         "--enable_eval",
        //     ],
        //     "program": "${workspaceFolder}/psilab/scripts_psi/workflows/imitation_learning/play.py",
        //     "console": "integratedTerminal",
        //     "justMyCode": false
        // },
        // // 旧版RGB测试（保留）
        {
            "name": "IL-Grasp-Beaker-003-v1:Play",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--task",
                "Psi-IL-Grasp-Beaker-003-v1",
                "--num_envs",
                "1",
                "--seed",
                "17",
                "--scene",
                "room_cfg:PSI_DC_Beaker_003_CFG",
                "--enable_cameras",
                "--async_reset",
                "--checkpoint",
                "/home/psibot/chembench/data/outputs/2025.12.18/03.37.22_train_diffusion_transformer_timm_dex_image_single_demo/checkpoints/epoch=0300-train_loss=0.007.ckpt",
                "--max_step",
                "500",
                "--max_episode",
                "200",
                "--enable_eval",
            ],
            "program": "${workspaceFolder}/psilab/scripts_psi/workflows/imitation_learning/play.py",
            "console": "integratedTerminal",
            "justMyCode": false
        },

        // ============================================
        // Motion Planning 数据收集配置
        // ============================================
        {
            "name": "MP-Grasp-Beaker-003-v1:DataCollect",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--task",
                "Psi-MP-Grasp-Beaker-003-v1",
                "--num_envs",
                "1",
                "--seed",
                "17",
                "--scene",
                "room_cfg:PSI_DC_Beaker_003_CFG",
                "--enable_cameras",
                "--enable_output",
                "--enable_random",
                "--enable_eval",
                "--async_reset",
                "--sample_step",
                "4",
                "--max_episode",
                "100",
            ],
            "program": "${workspaceFolder}/psilab/scripts_psi/workflows/motion_planning/play.py",
            "console": "integratedTerminal",
            "justMyCode": false
        },
    

        // ============================================
        // 数据处理工具
        // ============================================
        {
            "name": "Replay",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--enable_cameras",
                "--hdf5_file_folder",
                "${workspaceFolder}/psilab/outputs/Mp_grasp/Beaker_003/20251217_161148",
                "--enable_state"
            ],
            "program": "${workspaceFolder}/psilab/scripts_psi/workflows/replay/replay.py",
            "console": "integratedTerminal",
            "justMyCode": false
        },
        
        {
            "name": "HDF5 Convert",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--source",
                "${workspaceFolder}/psilab/outputs/source_data",
                "--destination",
                "${workspaceFolder}/psilab/outputs/converted_data",
            ],
            "program": "${workspaceFolder}/psilab/scripts_psi/tools/hdf5/convert_hdf5.py",
            "console": "integratedTerminal",
            "justMyCode": false
        },
        // ============================================
        // HDF5 to Zarr 数据转换
        // 使用说明：
        // 1. 修改 --h5_dir 为你的原始数据目录
        // 2. 输出会自动按照路径结构生成，如：
        //    输入: data/motion_plan/grasp/100ml玻璃烧杯/20251218_215604
        //    State输出: data/zarr_state/motion_plan/grasp/100ml玻璃烧杯.zarr
        //    RGB输出: data/zarr_rgb/motion_plan/grasp/100ml玻璃烧杯.zarr
        // ============================================
        {
            "name": "HDF5 to Zarr (State-Based)",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--h5_dir",
                "${workspaceFolder}/data/motion_plan/grasp/100ml玻璃烧杯/20251218_215604",
                "--zarr_dir",
                "${workspaceFolder}/data/zarr_state",
                "--mode",
                "state"
            ],
            "program": "${workspaceFolder}/psilab/source/psilab/psilab/utils/zarr_utils.py",
            "console": "integratedTerminal",
            "justMyCode": false
        },
        {
            "name": "HDF5 to Zarr (RGB-Based)",
            "type": "debugpy",
            "request": "launch",
            "args": [
                "--h5_dir",
                "${workspaceFolder}/data/motion_plan/grasp/100ml玻璃烧杯/20251218_215604",
                "--zarr_dir",
                "${workspaceFolder}/data/zarr_rgb",
                "--mode",
                "rgb"
            ],
            "program": "${workspaceFolder}/psilab/source/psilab/psilab/utils/zarr_utils.py",
            "console": "integratedTerminal",
            "justMyCode": false
        }
    ]
}
