{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "完整流程：转换+训练",
            "type": "shell",
            "command": "bash",
            "args": ["train_grasp.sh"],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "转换Zarr到HDF5",
            "type": "shell",
            "command": "python3",
            "args": [
                "convert_zarr_to_hdf5.py",
                "--zarr_path", "/share_data/liyufeng/code/chembench/data/final_real/data/grasp/part1/100ml玻璃烧杯.zarr",
                "--output_dir", "${workspaceFolder}/data/grasp_100ml_beaker",
                "--camera_names", "head_camera", "chest_camera"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "训练ACT（完整2000轮）",
            "type": "shell",
            "command": "python3",
            "args": [
                "train_from_zarr.py",
                "--zarr_path", "/share_data/liyufeng/code/chembench/data/final_real/data/grasp/part1/100ml玻璃烧杯.zarr",
                "--dataset_dir", "${workspaceFolder}/data/grasp_100ml_beaker",
                "--ckpt_dir", "${workspaceFolder}/ckpts/grasp_100ml_beaker",
                "--camera_names", "head_camera", "chest_camera",
                "--batch_size", "8",
                "--num_epochs", "2000",
                "--lr", "1e-5",
                "--seed", "0",
                "--kl_weight", "10",
                "--chunk_size", "100",
                "--hidden_dim", "512",
                "--dim_feedforward", "3200",
                "--skip_conversion"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "快速测试（10轮）",
            "type": "shell",
            "command": "python3",
            "args": [
                "train_from_zarr.py",
                "--zarr_path", "/share_data/liyufeng/code/chembench/data/final_real/data/grasp/part1/100ml玻璃烧杯.zarr",
                "--dataset_dir", "${workspaceFolder}/data/grasp_100ml_beaker",
                "--ckpt_dir", "${workspaceFolder}/ckpts/grasp_100ml_beaker_test",
                "--camera_names", "head_camera", "chest_camera",
                "--batch_size", "4",
                "--num_epochs", "10",
                "--lr", "1e-5",
                "--seed", "0",
                "--kl_weight", "10",
                "--chunk_size", "100",
                "--hidden_dim", "512",
                "--dim_feedforward", "3200",
                "--skip_conversion"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "修补模型以支持自定义维度",
            "type": "shell",
            "command": "python3",
            "args": ["patch_detr_for_custom_dims.py"],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "恢复原始模型代码",
            "type": "shell",
            "command": "python3",
            "args": ["patch_detr_for_custom_dims.py", "restore"],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "查看训练进度（最新检查点）",
            "type": "shell",
            "command": "ls",
            "args": ["-lht", "ckpts/grasp_100ml_beaker/*.ckpt"],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "查看训练曲线",
            "type": "shell",
            "command": "find",
            "args": ["ckpts/", "-name", "*.png", "-type", "f"],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        }
    ]
}


